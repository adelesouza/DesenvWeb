<!DOCTYPE html>
<html lang="en">
  <head>
    <title>AAJ - Admin3</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="apple-touch-icon" href="assets/img/apple-icon.png" />
    <link rel="shortcut icon" type="image/x-icon" href="assets/logo_AAJ.png" />

    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/templatemo.css" />
    <link rel="stylesheet" href="assets/css/custom.css" />

    <!-- Start Script -->
    <script src="assets/js/jquery-1.11.0.min.js"></script>
    <script src="assets/js/jquery-migrate-1.2.1.min.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/templatemo.js"></script>
    <script src="assets/js/custom.js"></script>

    <!-- Load fonts style after rendering the layout styles -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;200;300;400;500;700;900&display=swap"
    />
    <link rel="stylesheet" href="assets/css/fontawesome.min.css" />

    <!-- Load map styles -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
      integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
      crossorigin=""
    />
    <!--
    
TemplateMo 559 Zay Shop

https://templatemo.com/tm-559-zay-shop

-->
  </head>

  <body>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <nav class="navbar navbar-expand-lg navbar-light shadow bg-white">
      <div class="container d-flex justify-content-between align-items-center">
        <img src="./assets/logo_AAJ.png" alt="logo" href="index.html" />

        <button
          class="navbar-toggler border-0"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#templatemo_main_nav"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div
          class="align-self-center collapse navbar-collapse flex-fill d-lg-flex justify-content-lg-between"
          id="templatemo_main_nav"
        >
          <div class="flex-fill">
            <ul
              class="nav navbar-nav d-flex justify-content-between mx-lg-auto"
            >
              <li class="nav-item">
                <a class="nav-link mx-lg-auto" href="adm1.html">Produtos</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="adm3.html">Usuários</a>
              </li>
            </ul>
          </div>
          <div class="navbar align-self-center d-flex">
            <div
              class="d-lg-none flex-sm-fill mt-3 mb-4 col-7 col-sm-auto pr-3"
            ></div>
          </div>
        </div>
      </div>
    </nav>

    <div id="output"></div>

    <div class="container py-5">
      <div class="row-12 py-3">
        <div class="col-md-9 m-auto">
          <div class="row">
            <h3 class="h3 col-md-9 align-self-center">Buscar usuários</h3>
            <button
              type="button"
              class="col-md-3 btn btn-success px-3"
              href="adm4.html"
            >
              <a class="nav-icon position-relative text-white" href="adm4.html"
                >Listar usuários</a
              >
            </button>
          </div>
        </div>
      </div>

      <div class="row-12 py-3">
        <form action="" id="form1"></form>
        <div class="col-md-9 m-auto">
          <div class="row align-items-center">
            <div class="form-group col-md-4 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="codigo"
                name="codigo"
                placeholder="Código"
              />
            </div>
            <div class="form-group col-md-4 mb-3">
              <button class="btn btn-black px-3" id="buscar">Buscar</button>
            </div>
          </div>

          <hr />

          <div class="row">
            <div class="form-group col-md-4 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="nome"
                name="name"
                placeholder="Nome"
              />
            </div>
            <div class="form-group col-md-4 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="sobrenome"
                name="sobrenome"
                placeholder="Sobrenome"
              />
            </div>
            <div class="form-group col-md-4 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="sexo"
                name="sexo"
                placeholder="Sexo"
              />
            </div>
          </div>

          <div class="row">
            <div class="form-group col-md-4 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="dataNascimento"
                name="dataNascimento"
                placeholder="Data de nascimento"
              />
            </div>
            <div class="form-group col-md-4 mb-3">
              <input
                type="number"
                class="form-control mt-1"
                id="telefone"
                name="telefone"
                placeholder="Telefone"
              />
            </div>
            <div class="form-group col-md-4 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="cpf"
                name="cpf"
                placeholder="CPF"
              />
            </div>
          </div>

          <div class="row">
            <div class="form-group col-md-4 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="cep"
                name="cep"
                placeholder="CEP"
              />
            </div>
            <div class="form-group col-md-6 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="endereco"
                name="endereco"
                placeholder="Endereço"
              />
            </div>
            <div class="form-group col-md-2 mb-3">
              <input
                type="number"
                class="form-control mt-1"
                id="numero"
                name="numero"
                placeholder="Número"
              />
            </div>
          </div>

          <div class="row">
            <div class="form-group col-md-4 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="complemento"
                name="complemento"
                placeholder="Complemento"
              />
            </div>
            <div class="form-group col-md-6 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="bairro"
                name="bairro"
                placeholder="Bairro"
              />
            </div>
          </div>

          <div class="row">
            <div class="form-group col-md-4 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="estado"
                name="estado"
                placeholder="Estado"
              />
            </div>
            <div class="form-group col-md-6 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="cidade"
                name="cidade"
                placeholder="Cidade"
              />
            </div>
          </div>

          <div class="row">
            <div class="form-group col-md-2 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="tipo"
                name="tipo"
                placeholder="Tipo"
              />
            </div>
          </div>

          <div class="row mt-4">
            <div class="col-auto text-start mt-2">
              <button class="btn btn-success px-3" id="salvar_alter">
                Salvar alterações
              </button>
            </div>
            <div class="col-3 text-start mt-2">
              <button type="submit" class="btn btn-cancel px-3" id="btnDeletar">
                Deletar usuário
              </button>
            </div>
          </div>
          <!-- <div class="row mt-5">
            <div class="col-12">
              <div class="row">
                <h6 class="h6 col-md-12 align-self-center">
                  *Permissão 1: “Quero receber notificações sobre os meus
                  pedidos por SMS”
                </h6>
              </div>
              <div class="row">
                <h6 class="h6 col-md-12 align-self-center">
                  *Permissão 2: “Quero receber ofertas e novidades da AAJ por
                  e-mail”
                </h6>
              </div>
              <div class="row">
                <h6 class="h6 col-md-12 align-self-center">
                  *Permissão 3: “Concordo com o uso dos meus dados para compra e
                  experiência no site conforme a Política de Privacidade.”
                </h6>
              </div>
            </div> -->
        </div>
      </div>
    </div>

    <script>
      const codigoInput = document.getElementById('codigo')
      const nomeInput = document.getElementById('nome')
      const sobrenomeInput = document.getElementById('sobrenome')
      const sexoInput = document.getElementById('sexo')
      const dataNascimentoInput = document.getElementById('dataNascimento')
      const telefoneInput = document.getElementById('telefone')
      const cpfInput = document.getElementById('cpf')
      const cepInput = document.getElementById('cep')
      const enderecoInput = document.getElementById('endereco')
      const numeroInput = document.getElementById('numero')
      const complementoInput = document.getElementById('complemento')
      const bairroInput = document.getElementById('bairro')
      const estadoInput = document.getElementById('estado')
      const cidadeInput = document.getElementById('cidade')

      const tipoInput = document.getElementById('tipo')

      const btnBuscar = document.getElementById('buscar')
      const btnsalvar_alter = document.getElementById('salvar_alter')
      const btnDeletar = document.getElementById('btnDeletar')

      btnBuscar.addEventListener('click', () => {
        const codigo = codigoInput.value

        axios
          .get('http://localhost:3000/usuario/' + codigo + '')
          .then(function (response) {
            nomeInput.value = response.data.nome
            sobrenomeInput.value = response.data.sobrenome
            sexoInput.value = response.data.sexo
            dataNascimentoInput.value = response.data.data_nascimento
            telefoneInput.value = response.data.telefone
            cpfInput.value = response.data.cpf
            cepInput.value = response.data.cep
            enderecoInput.value = response.data.endereco
            numeroInput.value = response.data.numero
            complementoInput.value = response.data.complemento
            bairroInput.value = response.data.bairro
            estadoInput.value = response.data.estado
            cidadeInput.value = response.data.cidade
            tipoInput.value = response.data.tipo
          })
          .catch(function (err) {
            document.getElementById('output').innerHTML =
              '<div class="alert alert-danger" role="alert"><strong>' +
              err.message +
              '</strong></div>'
          })
      })

      btnsalvar_alter.addEventListener('click', () => {
        const codigo = codigoInput.value

        const nome = nomeInput.value
        const sobrenome = sobrenomeInput.value
        const sexo = sexoInput.value
        const dataNascimento = dataNascimentoInput.value
        const telefone = telefoneInput.value
        const cpf = cpfInput.value
        const cep = cepInput.value
        const endereco = enderecoInput.value
        const numero = numeroInput.value
        const complemento = complementoInput.value
        const bairro = bairroInput.value
        const estado = estadoInput.value
        const cidade = cidadeInput.value

        console.log('oi')

        if (codigo == '') {
          axios
            .post('http://localhost:3000/usuario', {
              nome: nome,
              sobrenome: sobrenome,
              sexo: sexo,
              data_nascimento: dataNascimento,
              telefone: telefone,
              cpf: cpf,
              cep: cep,
              endereco: endereco,
              numero: numero,
              complemento: complemento,
              bairro: bairro,
              estado: estado,
              cidade: cidade
            })
            .then(response => {
              output.innerHTML = `<div class="alert alert-success alert-dismissible fade show" role="alert">
        <strong>Sucesso!</strong> Cadastro efetuado.
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>`
              form1.reset()
            })
            .catch(function (err) {
              document.getElementById('output').innerHTML =
                `<div class="alert alert-danger alert-dismissible fade show" role="alert">
        <strong>Erro! </strong>` +
                err.message +
                `
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>`
            })
        } else {
          axios
            .put('http://localhost:3000/usuario/' + codigo + '', {
              nome: nome,
              sobrenome: sobrenome,
              sexo: sexo,
              data_nascimento: dataNascimento,
              telefone: telefone,
              cpf: cpf,
              cep: cep,
              endereco: endereco,
              numero: numero,
              complemento: complemento,
              bairro: bairro,
              estado: estado,
              cidade: cidade
            })
            .then(response => {
              output.innerHTML = `<div class="alert alert-primary alert-dismissible fade show" role="alert">
            <strong>Sucesso!</strong> Atualização efetuada.
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>`
            })
            .catch(function (err) {
              document.getElementById('output').innerHTML =
                `<div class="alert alert-danger alert-dismissible fade show" role="alert">
            <strong>Erro! </strong>` +
                err.message +
                `
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>`
            })
        }
      })

      btnDeletar.addEventListener('click', () => {
        const codigo = codigoInput.value

        axios
          .delete('http://localhost:3000/usuario/' + codigo + '')
          .then(function (response) {
            location.reload()
          })
          .catch(function (err) {
            document.getElementById('output').innerHTML =
              '<div class="alert alert-danger" role="alert"><strong>' +
              err.message +
              '</strong></div>'
          })
      })
    </script>
    <!-- End Script -->
  </body>
</html>
