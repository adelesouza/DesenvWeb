<!DOCTYPE html>
<html lang="en">
  <head>
    <title>AAJ - Admin</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link rel="apple-touch-icon" href="assets/img/apple-icon.png" />
    <link rel="shortcut icon" type="image/x-icon" href="assets/logo_AAJ.png" />

    <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/templatemo.css" />
    <link rel="stylesheet" href="assets/css/custom.css" />

    <!-- Load fonts style after rendering the layout styles -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;200;300;400;500;700;900&display=swap"
    />
    <link rel="stylesheet" href="assets/css/fontawesome.min.css" />

    <!-- Load map styles -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
      integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
      crossorigin=""
    />
    <!--
    
TemplateMo 559 Zay Shop

https://templatemo.com/tm-559-zay-shop

-->
  </head>

  <body>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <nav class="navbar navbar-expand-lg navbar-light shadow bg-white">
      <div class="container d-flex justify-content-between align-items-center">
        <img src="./assets/logo_AAJ.png" alt="logo" href="index.html" />

        <button
          class="navbar-toggler border-0"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#templatemo_main_nav"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div
          class="align-self-center collapse navbar-collapse flex-fill d-lg-flex justify-content-lg-between"
          id="templatemo_main_nav"
        >
          <div class="flex-fill">
            <ul
              class="nav navbar-nav d-flex justify-content-between mx-lg-auto"
            >
              <li class="nav-item">
                <a class="nav-link mx-lg-auto" href="adm1.html">Produtos</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="adm3.html">Usuários</a>
              </li>
            </ul>
          </div>
          <div class="navbar align-self-center d-flex">
            <div
              class="d-lg-none flex-sm-fill mt-3 mb-4 col-7 col-sm-auto pr-3"
            ></div>
          </div>
        </div>
      </div>
    </nav>
    <div id="output"></div>
    <div class="container py-5">
      <div class="row-12 py-3">
        <div class="col-md-9 m-auto">
          <div class="row">
            <h3 class="h3 col-md-9 align-self-center">Buscar produtos</h3>
            <button
              type="button"
              class="col-md-3 btn btn-success px-3"
              href="adm2.html"
            >
              <a class="nav-icon position-relative text-white" href="adm2.html"
                >Listar produtos</a
              >
            </button>
          </div>
        </div>
      </div>

      <div class="row-12 py-3">
        <div class="col-md-9 m-auto">
          <form action="" id="form1"></form>
          <div class="row align-items-center">
            <div class="form-group col-md-4 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="referencia"
                name="referencia"
                placeholder="Referência"
              />
            </div>
            <div class="form-group col-md-4 mb-3">
              <button id="btnBuscar" class="btn btn-black px-3">Buscar</button>
            </div>
          </div>

          <hr />

          <div class="row">
            <div class="form-group col-md-12 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="descricao"
                name="descricao"
                placeholder="Descrição"
              />
            </div>
          </div>

          <div class="row">
            <div class="form-group col-md-3 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="grupo"
                name="grupo"
                placeholder="Grupo"
              />
            </div>
            <div class="form-group col-md-3 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="subgrupo"
                name="subgrupo"
                placeholder="Sub-grupo"
              />
            </div>
            <div class="form-group col-md-3 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="uso"
                name="uso"
                placeholder="Uso (indicado para)"
              />
            </div>
            <div class="form-group col-md-3 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="origem"
                name="origem"
                placeholder="Origem"
              />
            </div>
          </div>

          <div class="row">
            <div class="form-group col-md-3 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="preco_compra"
                name="preco_compra"
                placeholder="Preço de compra"
              />
            </div>
            <div class="form-group col-md-3 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="preco_venda"
                name="preco_venda"
                placeholder="Preço de venda"
              />
            </div>
            <div class="form-group col-md-3 mb-3">
              <input
                type="estoque"
                class="form-control mt-1"
                id="estoque"
                name="estoque"
                placeholder="Estoque"
              />
            </div>
          </div>

          <div class="row mt-4">
            <div class="col-auto text-start mt-2">
              <button id="btnSalvar" class="btn btn-success px-3">
                Salvar alterações
              </button>
            </div>
            <!-- <div class="col-auto text-start mt-2">
              <button type="submit" class="btn btn-black px-3">Cancelar</button>
            </div> -->
            <div class="col-3 text-start mt-2">
              <button id="btnDeletar" class="btn btn-cancel px-3">
                Deletar produto
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container py-5">
      <div class="row-12 py-3">
        <div class="col-md-9 m-auto">
          <div class="row">
            <h3 class="h3 col-md-9 align-self-center">
              Buscar unidade de produto
            </h3>
          </div>
        </div>
      </div>

      <div class="row-12 py-3">
        <form action="" id="form2"></form>
        <div class="col-md-9 m-auto">
          <div class="row align-items-center">
            <div class="form-group col-md-4 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="cod_produto_und"
                name="cod_produto"
                placeholder="Código do produto"
              />
            </div>
            <div class="form-group col-md-4 mb-3">
              <button id="btnBuscarUnd" class="btn btn-black px-3">
                Buscar
              </button>
            </div>
          </div>

          <hr />

          <div class="row">
            <div class="form-group col-md-4 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="ref_und"
                name="ref"
                placeholder="Referência"
              />
            </div>
          </div>

          <div class="row">
            <div class="form-group col-md-12 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="descricao_und"
                name="descricao_und"
                placeholder="Descrição"
              />
            </div>
          </div>

          <div class="row">
            <div class="form-group col-md-3 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="grupo_und"
                name="grupo_und"
                placeholder="Grupo"
              />
            </div>
            <div class="form-group col-md-3 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="subgrupo_und"
                name="subgrupo_und"
                placeholder="Sub-grupo"
              />
            </div>
            <div class="form-group col-md-3 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="uso_und"
                name="uso_und"
                placeholder="Uso (indicado para)"
              />
            </div>
            <div class="form-group col-md-3 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="origem_und"
                name="origem_und"
                placeholder="Origem"
              />
            </div>
          </div>

          <div class="row">
            <div class="form-group col-md-3 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="preco_compra_und"
                name="preco_compra_und"
                placeholder="Preço de compra"
              />
            </div>

            <div class="form-group col-md-3 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="estoque_und"
                name="estoque_und"
                placeholder="Estoque"
              />
            </div>
          </div>

          <hr />

          <div class="row">
            <div class="form-group col-md-6 mb-3">
              <input
                type="text"
                class="form-control mt-1"
                id="img_src_input"
                name="img_src_input"
                placeholder="URL Imagem"
              />
              <img class="mt-" id="img_und" src="" alt="" />
            </div>
            <div class="form-group col-md-3 mb-3">
              <div class="row mb-3">
                <input
                  type="text"
                  class="form-control mt-1"
                  id="preco_venda_und"
                  name="preco_venda_und"
                  placeholder="Preço de venda"
                />
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-auto text-start mt-2">
              <button id="btnSalvarUnd" class="btn btn-success px-3">
                Salvar alterações
              </button>
            </div>
            <!-- <div class="col-auto text-start mt-2">
              <button type="submit" class="btn btn-black px-3">Cancelar</button>
            </div> -->
            <div class="col-6 text-start mt-2">
              <button id="btnDeletarUnd" class="btn btn-cancel px-3">
                Deletar Unidade Produto
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Start Script -->
    <script src="assets/js/jquery-1.11.0.min.js"></script>
    <script src="assets/js/jquery-migrate-1.2.1.min.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script src="assets/js/templatemo.js"></script>
    <script src="assets/js/custom.js"></script>
    <script>
      const form = document.getElementById('form1')
      const referenciaInput = document.getElementById('referencia')
      const descricaoInput = document.getElementById('descricao')
      const grupoInput = document.getElementById('grupo')
      const subgrupoInput = document.getElementById('subgrupo')
      const usoInput = document.getElementById('uso')
      const origemInput = document.getElementById('origem')
      const precoCompraInput = document.getElementById('preco_compra')
      const precoVendaInput = document.getElementById('preco_venda')
      const estoqueInput = document.getElementById('estoque')

      const btnSalvar = document.getElementById('btnSalvar')
      const btnDeletar = document.getElementById('btnDeletar')
      const btnBuscar = document.getElementById('btnBuscar')

      const form2 = document.getElementById('form2')
      const codProdutoInputUnd = document.getElementById('cod_produto_und')
      const referenciaInputUnd = document.getElementById('ref_und')
      const descricaoInputUnd = document.getElementById('descricao_und')
      const grupoInputUnd = document.getElementById('grupo_und')
      const subgrupoInputUnd = document.getElementById('subgrupo_und')
      const usoInputUnd = document.getElementById('uso_und')
      const origemInputUnd = document.getElementById('origem_und')
      const precoCompraInputUnd = document.getElementById('preco_compra_und')
      const precoVendaInputUnd = document.getElementById('preco_venda_und')
      const estoqueInputUnd = document.getElementById('estoque_und')
      const imgInput = document.getElementById('img_src_input')
      const img = document.getElementById('img_und')

      const btnSalvarUnd = document.getElementById('btnSalvarUnd')
      const btnDeletarUnd = document.getElementById('btnDeletarUnd')
      const btnBuscarUnd = document.getElementById('btnBuscarUnd')

      btnSalvar.addEventListener('click', () => {
        const referencia = referenciaInput.value
        const descricao = descricaoInput.value
        const grupo = grupoInput.value
        const subgrupo = subgrupoInput.value
        const uso = usoInput.value
        const origem = origemInput.value
        const preco_compra = precoCompraInput.value
        const preco_venda = precoVendaInput.value
        const estoque = estoqueInput.value

        console.log(referencia)

        if (referencia == '') {
          axios
            .post('http://localhost:3000/produto/', {
              descricao: descricao,
              grupo: grupo,
              subgrupo: subgrupo,
              uso: uso,
              origem: origem,
              preco_compra: preco_compra,
              preco_venda: preco_venda,
              estoque: estoque
            })
            .then(response => {
              output.innerHTML = `<div class="alert alert-success alert-dismissible fade show" role="alert">
            <strong>Sucesso!</strong> Cadastro efetuado.
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>`
              form.reset()
            })
            .catch(function (err) {
              document.getElementById('output').innerHTML =
                `<div class="alert alert-danger alert-dismissible fade show" role="alert">
            <strong>Erro! </strong>` +
                err.message +
                `
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>`
            })
        } else {
          axios
            .put('http://localhost:3000/produto/' + referencia + '', {
              descricao: descricao,
              grupo: grupo,
              subgrupo: subgrupo,
              uso: uso,
              origem: origem,
              preco_compra: preco_compra,
              preco_venda: preco_venda,
              estoque: estoque
            })
            .then(response => {
              output.innerHTML = `<div class="alert alert-primary alert-dismissible fade show" role="alert">
            <strong>Sucesso!</strong> Atualização efetuada.
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>`
            })
            .catch(function (err) {
              document.getElementById('output').innerHTML =
                `<div class="alert alert-danger alert-dismissible fade show" role="alert">
            <strong>Erro! </strong>` +
                err.message +
                `
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>`
            })
        }
      })
      btnDeletar.addEventListener('click', () => {
        const referencia = referenciaInput.value

        axios
          .delete('http://localhost:3000/produto/' + referencia + '')
          .then(function (response) {
            location.reload()
          })
          .catch(function (err) {
            document.getElementById('output').innerHTML =
              '<div class="alert alert-danger" role="alert"><strong>' +
              err.message +
              '</strong></div>'
          })
      })
      btnBuscar.addEventListener('click', () => {
        const referencia = referenciaInput.value

        axios
          .get('http://localhost:3000/produto/' + referencia + '')
          .then(function (response) {
            document.getElementById('descricao').value = response.data.descricao
            document.getElementById('grupo').value = response.data.grupo
            document.getElementById('subgrupo').value = response.data.subgrupo
            document.getElementById('uso').value = response.data.uso
            document.getElementById('origem').value = response.data.origem
            document.getElementById('preco_compra').value =
              response.data.preco_compra
            document.getElementById('preco_venda').value =
              response.data.preco_venda
            document.getElementById('estoque').value = response.data.estoque
          })
          .catch(function (err) {
            document.getElementById('output').innerHTML =
              '<div class="alert alert-danger" role="alert"><strong>' +
              err.message +
              '</strong></div>'
          })
      })

      btnSalvarUnd.addEventListener('click', () => {
        const cod_produto = codProdutoInputUnd.value
        const referenciaUnd = referenciaInputUnd.value
        const descricaoUnd = descricaoInputUnd.value
        const grupoUnd = grupoInputUnd.value
        const subgrupoUnd = subgrupoInputUnd.value
        const usoUnd = usoInputUnd.value
        const origemUnd = origemInputUnd.value
        const preco_compraUnd = precoCompraInputUnd.value
        const preco_vendaUnd = precoVendaInputUnd.value
        const estoqueUnd = estoqueInputUnd.value
        const imgSrc = imgInput.value

        if (cod_produto == '') {
          axios
            .post('http://localhost:3000/undproduto/', {
              referencia: referenciaUnd,
              descricao: descricaoUnd,
              grupo: grupoUnd,
              subgrupo: subgrupoUnd,
              uso: usoUnd,
              origem: origemUnd,
              preco_compra: preco_compraUnd,
              preco_venda: preco_vendaUnd,
              estoque: estoqueUnd,
              img: imgSrc
            })
            .then(response => {
              output.innerHTML = `<div class="alert alert-success alert-dismissible fade show" role="alert">
            <strong>Sucesso!</strong> Cadastro efetuado.
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>`
              form2.reset()
            })
            .catch(function (err) {
              document.getElementById('output').innerHTML =
                `<div class="alert alert-danger alert-dismissible fade show" role="alert">
            <strong>Erro! </strong>` +
                err.message +
                `
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>`
            })
        } else {
          axios
            .put('http://localhost:3000/undproduto/' + cod_produto + '', {
              referencia: referenciaUnd,
              descricao: descricaoUnd,
              grupo: grupoUnd,
              subgrupo: subgrupoUnd,
              uso: usoUnd,
              origem: origemUnd,
              preco_compra: preco_compraUnd,
              preco_venda: preco_vendaUnd,
              estoque: estoqueUnd,
              img: imgSrc
            })
            .then(response => {
              output.innerHTML = `<div class="alert alert-primary alert-dismissible fade show" role="alert">
            <strong>Sucesso!</strong> Atualização efetuada.
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>`
            })
            .catch(function (err) {
              document.getElementById('output').innerHTML =
                `<div class="alert alert-danger alert-dismissible fade show" role="alert">
            <strong>Erro! </strong>` +
                err.message +
                `
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>`
            })
        }
      })
      btnBuscarUnd.addEventListener('click', () => {
        const cod_produto = codProdutoInputUnd.value

        axios
          .get('http://localhost:3000/undproduto/' + cod_produto + '')
          .then(function (response) {
            document.getElementById('ref_und').value = response.data.referencia
            document.getElementById('descricao_und').value =
              response.data.descricao
            document.getElementById('grupo_und').value = response.data.grupo
            document.getElementById('subgrupo_und').value =
              response.data.subgrupo
            document.getElementById('uso_und').value = response.data.uso
            document.getElementById('origem_und').value = response.data.origem
            document.getElementById('preco_compra_und').value =
              response.data.preco_compra
            document.getElementById('preco_venda_und').value =
              response.data.preco_venda
            document.getElementById('estoque_und').value = response.data.estoque
            document.getElementById('img_src_input').value = response.data.img
            document.getElementById('img_und').src = response.data.img
          })
          .catch(function (err) {
            document.getElementById('output').innerHTML =
              '<div class="alert alert-danger" role="alert"><strong>' +
              err.message +
              '</strong></div>'
          })
      })
      btnDeletarUnd.addEventListener('click', () => {
        const cod_produto = codProdutoInputUnd.value

        axios
          .delete('http://localhost:3000/undproduto/' + cod_produto + '')
          .then(function (response) {
            location.reload()
          })
          .catch(function (err) {
            document.getElementById('output').innerHTML =
              '<div class="alert alert-danger" role="alert"><strong>' +
              err.message +
              '</strong></div>'
          })
      })
    </script>
    <!-- End Script -->
  </body>
</html>
